size=0.5) +
labs(x = "Coefficient", y = "") +
theme_light() +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14))
h
ggsave("figures/Linear-model-Co2.png", width = 8, height = 2, dpi = 600)
New.labs <- c("10°C", "20°C", "30°C") # Change labels
names(New.labs) <- c("10", "20", "30")
New.labs_b <-  c("[0-10 cm]", "[10-20 cm]", "[20-30 cm]") # Change labels
names(New.labs_b) <- c("10", "20", "30")
options(repr.plot.width = 8, repr.plot.height = 6)
pl <- data_co2_clean |>
bind_cols(10^prediction) |>
ggplot(aes(x = `Time (days)`, y = `CO2 emission (ug/h/g)`)) +
geom_point(size = 2, alpha = .3) +
facet_grid(`Depth (cm)` ~ `Temperature (°C)`, scales = "free", labeller = labeller(`Depth (cm)` = New.labs_b, `Temperature (°C)` = New.labs)) +
geom_line(aes(x = `Time (days)`, y = `.pred`)) +
scale_y_log10() +
theme_bw() +
theme(strip.text = element_text(size = 12), axis.text=element_text(size=12),
axis.title=element_text(size=14),
axis.title.y = element_text(size=14)) +
xlab("Incubation time (days)") + ylab(bquote(~CO[2]~ 'emision rate ('*mu~'g'~ h^-1~g^-1*')'))
pl
ggsave("figures/CO2 emission.png", plot= pl, width = 7, height = 5, dpi = 600)
models_co2 <- data_co2 %>%
group_by(`Depth (cm)`) %>%
summarise(linmod = list(lm(lnK ~ `1/T`)))
models_co2
linmod_coef <- list()
for (i in seq_along(models_co2$linmod)) linmod_coef[[i]] <- models_co2$linmod[[i]]$coefficients
linmod_coef <- do.call(rbind.data.frame, linmod_coef)
names(linmod_coef) <- c("Intercept", "Slope")
linmod_coef <- bind_cols(unique(data_co2["Depth (cm)"]), linmod_coef)
linmod_coef
options(repr.plot.width = 12, repr.plot.height = 6)
plot_co2 <- data_co2_clean %>%
ggplot(aes(x = `1/T`, y = lnK)) +
facet_grid(~`Depth (cm)`, labeller = labeller(`Depth (cm)` = New.labs_b)) +
geom_boxplot(aes(group = factor(`1/T`))) +
stat_regline_equation(aes(label =  paste(..eq.label.., ..rr.label.., sep = "~~")), label.x = 0.00331, label.y = -7) +
geom_abline(data = linmod_coef, aes(intercept = Intercept, slope = Slope), lwd = 1) +
labs(y = "ln(K)") +
theme_bw() +
theme(strip.text = element_text(size = 14), axis.text=element_text(size=14),
axis.title=element_text(size=14))
plot_co2
ggsave("figures/Arrhénius équation.png", plot = plot_co2, width = 8, height = 4, dpi = 600)# export plot high resolution
Activation_energy <- tibble(
Soil_layers = c("10", "20", "30"),
intercept = NA,
slope = NA,
adj_r_sq = NA
)
lm_arrhenius <- for (i in 1:nrow(Activation_energy)) {
lm_Activation_energy <- data_co2_clean %>%
filter(`Depth (cm)` == Activation_energy$Soil_layers[i]) %>%
lm(lnK ~ `1/T`, data = .)
# intercept
Activation_energy$intercept[i] <- coef(lm_Activation_energy)[1]
# Slope
Activation_energy$slope[i] <- coef(lm_Activation_energy)[2]
# statistics
Activation_energy$adj_r_sq[i] <- summary(lm_Activation_energy)$adj.r.squared
}
R = 8.3144621 / 1000 # Gas constant Kj/mol/K
Activation_energy <-  Activation_energy %>%
mutate(Ea = -slope * R) %>%
select(Soil_layers, adj_r_sq, Ea)
Activation_energy
K_median <- aggregate(K ~ `Sites` + `Time (days)` + `Depth (cm)` + `Temperature (°C)`, data = data_co2_clean, FUN = median)
K_median <- K_median %>%
pivot_wider(names_from = `Temperature (°C)`, values_from = K)
K_median$Q_20_10 <- K_median$`20` / K_median$`10`
K_median$Q_30_20 <- K_median$`30` / K_median$`20`
K_median <- K_median_02 %>%
na.omit(K_median)
data_Q10 <- gather(data = K_median, key = `Temperature range`, value = Q10, c(`Q_20_10`, `Q_30_20`),
factor_key=TRUE)
stat_Q10 <- data_Q10 |>
group_by(`Depth (cm)`) |>
get_summary_stats(Q10)
stat_Q10
New.labs_c <- c("[10°C - 20°C]", "[20°C - 30°C]") # Change labels
names(New.labs_c) <- c("Q_20_10", "Q_30_20")
options(repr.plot.width = 8, repr.plot.height = 4)
data_Q10 |>
mutate(`Layers` = as.character(`Depth (cm)`)) |>
ggplot(aes(x = `Time (days)`, y = `Q10`)) +
facet_grid(`Temperature range`~`Depth (cm)`, labeller = labeller(`Depth (cm)` = New.labs_b,
`Temperature range` = New.labs_c)) +
geom_smooth(method = "lm", se = TRUE, color = "Black") +
geom_point(size = 1.5, alpha = 0.6) +
theme_bw() +
theme(strip.text = element_text(size = 14), axis.text=element_text(size=14),
axis.title=element_text(size=14))
ggsave("figures/Variation of Q10 across layers.png", width = 8, height = 4, dpi = 600)# export plot high resolution
data_carbon_credit <- read_csv2('data/data_carbon_credit.csv')
data_carbon_credit <- data_carbon_credit |>
mutate(`C:N ratio` = `Carbone (%)` / `Nitrogen (%)`)
mean_sd_CoverN <- data_carbon_credit |>
group_by(`Layer (cm)`) |>
summarize(mean_C_over_N = mean(`C:N ratio`, na.rm = TRUE),
se_C_over_N = sd(`C:N ratio`, na.rm = TRUE)/sqrt(length(!is.na(`C:N ratio`))))
mean_sd_CoverN
data_carbon_credit |> get_summary_stats(`C stock (kg m-3)`)
data_carbon_credit |>
group_by(`Layer (cm)`) |>
get_summary_stats(`C stock (kg m-3)`)
data_carbon_credit |>
group_by(`Layer (cm)`) |>
get_summary_stats(`C:N ratio`)
plot_desc <- function(y, ylab){
New.labs_c <-  c("Site/A9", "Site/45") # Change labels
names(New.labs_c) <- c("Belanger/ A9", "Fortier/ 45")
ggplot(data_carbon_credit, aes(`Layer (cm)`, y)) +
facet_grid( . ~ `Location`, scales = "free", labeller = labeller(`Location` = New.labs_c)) +
geom_boxplot() +
theme_bw() +
theme(strip.text = element_text(size = 11), axis.text=element_text(size=11),
axis.title=element_text(size=11)) +
labs(y = ylab)
}
plot1 <- plot_desc(data_carbon_credit$`C stock (kg m-3)`, "C stock (kg m-3)")
plot2 <- plot_desc(data_carbon_credit$`C:N ratio`, "C:N ratio")
plot3 <- plot_desc(data_carbon_credit$`Bulk density (kg m-3)`, "Bulk density (kg m-3)")
plot4 <- plot_desc(data_carbon_credit$pHCaCl2, "pHCaCl2")
plot5 <- plot_desc(data_carbon_credit$`Total porosity`, "Total porosity")
plot6 <- plot_desc(data_carbon_credit$`Water content (%)`, "Water content (%)")
options(repr.plot.width = 8, repr.plot.height = 6)
figure <- ggarrange(plot1, plot2, plot3, plot4, plot5, plot6,
labels = c("A", "B", "C", "D", "E", "F"), label.x = 0.05, label.y = 1.01,
ncol = 2, nrow = 3)
figure
ggsave("figures/Soil description.png", width = 8, height = 5, dpi = 600)# export plot high resolution
Carbon_credit <- read_csv2('data/data_carbon_sublayer.csv')
Carbon_credit
Carbon_credit <- Carbon_credit %>%
mutate(`C/N` = C_pourc/N_pourc)
options(repr.plot.width=8, repr.plot.height=4)
New.labs_d <-  c("Site/A9", "Site/45") # Change labels
names(New.labs_d) <- c("Belanger/A9", "Fortier/45")
ggplot(data=Carbon_credit, aes(x= `Depht (cm)`, y= `C/N`)) +
facet_grid(.~Site, labeller = labeller(`Site` = New.labs_d)) +
geom_line(linetype = "twodash") +
geom_point(aes(shape = `Soil texture`, fill = `Soil texture`), size = 3) +
scale_shape_manual(values=c(21, 21))+
scale_fill_manual(values = c("#000000", "#FFFFFF")) +
scale_y_continuous(breaks = 5*0:1000,
expand = expand_scale(add = 5)) +
scale_x_continuous(breaks = 5*0:1000,
expand = expand_scale(add = 5)) +
theme(strip.text = element_text(face = "bold"), axis.text=element_text(face = "bold"),
axis.title=element_text(face = "bold") , legend.title= element_text(face = "bold"),
legend.text = element_text(face = "bold")) +
labs(y= "C/N Ratio") +
coord_flip()
ggsave("figures/(C_over_N).png", width = 8, height = 4, dpi = 800)
?stringr::boundary()
pattern <- "a.b"
strings <- c("abb", "a.b")
pattern
strings
str_detect(strings, pattern)
str_detect(strings, fixed(pattern))
pattern <- "a.b"
strings <- c("abb", "a.b")
str_detect(strings, pattern)
str_detect(strings, fixed(pattern))
str_detect(strings, coll(pattern))
i <- c("I", "\u0130", "i")
i
str_detect(i, fixed("i", TRUE))
str_detect(i, coll("i", TRUE))
str_detect(i, coll("i", TRUE, locale = "tr"))
words <- c("These are   some words.")
str_count(words, boundary("word"))
str_split(words, " ")[[1]]
str_split(words, boundary("word"))[[1]]
str_split(words, boundary("word"))[[2]]
str_extract_all("The Cat in the Hat", "[a-z]+")
str_extract_all("The Cat in the Hat", regex("[a-z]+", TRUE))
str_extract_all("a\nb\nc", "^.")
str_extract_all("a\nb\nc", regex("^.", multiline = TRUE))
str_extract_all("a\nb\nc", "a.")
str_extract_all("a\nb\nc", regex("a.", dotall = TRUE))
?stringr::str_c()
str_c("Letter: ", letters)
str_c("Letter: ")
str_c("Letter", letters, sep = ": ")
")
str_c(letters, " is for", "...")
str_c(letters, " is for", "...")
ggplotly(
data_co2 |>
ggplot() +
geom_histogram(aes(x = log10(`CO2 emission (ug/h/g)`)), bins = 150)
)
str_c(letters, " is for", "...")
str_c(letters[-26], " comes before ", letters[-1])
letters[-26]
letters[-1]
str_c(letters[-26], " comes before ", letters[-1])
str_c(letters, collapse = "")
str_c(letters, collapse = ", ")
tr_c(c("a", NA, "b"), "-d")
str_c(c("a", NA, "b"), "-d")
str_c(str_replace_na(c("a", NA, "b")), "-d")
print(Sys.Date())
#install.packages(c("ggpubr", "ggpmisc", "tidyverse", "tidymodels", "plyr", "plotly"))
#library(plyr)
library(tidyverse)
library(tidymodels)
library(ggpubr)
#library(ggpmisc)
#library(grid)
data_pots <- read_csv2('data/pots.csv')
data_co2 <- read_csv('data/co2.csv')
data_co2 <- data_co2 |>
left_join(data_pots, by = "ID pot")
data_pots
container_volume <- 250 # mL
gas_constant <- 8.31446 # unit
atm_pressure_n <- 101.325
data_co2 <- data_co2 %>%
mutate(`Temperature (K)` = `Temperature (°C)` + 273,
`Total carbon (Mg/ha)` = `Bulk density (g/cm3)` * `Carbone(%)` * 10,
`Molar Volume (L/mol)` = gas_constant * `Temperature (K)` / atm_pressure_n,
`Headspace Volume (mL)` = container_volume - (`Soil weight (g)` / `Bulk density (g/cm3)`), # 250 mL is the volume of the container
`Dry soil weight (g)` = `Soil weight (g)` - (`Soil weight (g)` * `Water content (%)` / 100),
`CO2 emission (ug/h/g)` = (`Final CO2 (ppm)` - `Initial CO2 (ppm)`) * 0.000001 * 44000000 /
`Molar Volume (L/mol)` * (`Headspace Volume (mL)` / 1000) * (12 / 44) /
`Time final (h)` / `Dry soil weight (g)`,
`CO2 emission (mg/kg)` = `CO2 emission (ug/h/g)` * 24 * `Time (days)`,
`CO2 emission (Mg/ha)` = `CO2 emission (mg/kg)` * `Bulk density (g/cm3)` * 10 * 0.0001,
K = log(`Total carbon (Mg/ha)` / (`Total carbon (Mg/ha)` - `CO2 emission (Mg/ha)`)) / `Time (days)`,
lnK = log(K),
`1/T` = 1 / `Temperature (K)`)
New.labs <- c("10°C", "20°C", "30°C") # Change labels
names(New.labs) <- c("10", "20", "30")
New.labs_b <-  c("[0-10 cm]", "[10-20 cm]", "[20-30 cm]") # Change labels
names(New.labs_b) <- c("10", "20", "30")
library(plotly)
ggplotly(
data_co2 |>
ggplot() +
geom_histogram(aes(x = log10(`CO2 emission (ug/h/g)`)), bins = 150)
)
data_co2_clean <- data_co2 |>
mutate(log_tr = log10(`CO2 emission (ug/h/g)`)) |>
filter(log_tr > -3.06 & log_tr < -0.33) |>
drop_na()
ggplotly(
data_co2_clean |>
ggplot() +
geom_histogram(aes(x = log10(`CO2 emission (ug/h/g)`)), bins = 100)
)
data_co2_clean |>
select(`Time (days)`, `Depth (cm)`, `Temperature (°C)`, `CO2 emission (ug/h/g)`) |>
corrr::correlate() |>
corrr::focus(`CO2 emission (ug/h/g)`) |>
mutate(term = fct_reorder(term, `CO2 emission (ug/h/g)`)) |>
ggplot(aes(x = `CO2 emission (ug/h/g)`, y= term)) +
geom_col(width = 0.2) +
labs(x = bquote(~CO[2]~ 'emision ('*mu~'g'~ h^-1~g^-1*')')) +
theme_bw()
options(repr.plot.width = 6, repr.plot.height = 7)
pg <- ggplot(data=data_co2_clean, aes(x = `Time (days)`,y = `CO2 emission (ug/h/g)` )) +
geom_boxplot(aes(group = factor(`Time (days)`))) +
facet_grid(`Depth (cm)` ~ `Temperature (°C)`,   scales = "free",
labeller = labeller(`Depth (cm)` = New.labs_b, `Temperature (°C)` = New.labs))+
labs(x = "Incubation time (days)", y = bquote(~CO[2]~ 'emision ('*mu~'g'~ h^-1~g^-1*')'))
pg
ggsave("figures/Boxplot.png", width = 6, height = 7, dpi = 600)# export plot high resolution
model_rec <-  data_co2_clean |>
recipe(`CO2 emission (ug/h/g)` ~ ., data_co2) |>
step_select(`CO2 emission (ug/h/g)`, `Time (days)`, `Depth (cm)`, `Temperature (°C)`) |>
step_log(all_outcomes(), base = 10) |>
step_normalize(all_numeric(), -all_outcomes() ) |>
prep()
data_co2_preprocessed <-  juice(model_rec)
model_spec <- linear_reg() |>
set_engine("lm")
model_fit <- model_spec |>
fit(`CO2 emission (ug/h/g)` ~ ., data_co2_preprocessed)
tidy(model_fit)
glance(model_fit)
par(mfrow=c(2,2)) # plot all 4 plots in one
plot(model_fit$fit,
pch = 16,
col = '#006EA1')
prediction <-  model_fit |>
predict(data_co2_preprocessed)
rmse <-  data_co2_preprocessed |>
bind_cols(prediction) |>
rmse(`CO2 emission (ug/h/g)`, .pred)
rmse
rmse <-  round(as.numeric(rmse[1,3]), 2)
rsq <-  data_co2_preprocessed |>
bind_cols(prediction) |>
rsq(`CO2 emission (ug/h/g)`, .pred)
rsq
rsq <- round(as.numeric(rsq[1,3]), 2)
options(repr.plot.width = 4, repr.plot.height = 2)
px <- data_co2_preprocessed |>
bind_cols(prediction) |>
ggplot(aes(x = `CO2 emission (ug/h/g)`, y = .pred)) +
geom_point(size = 1, alpha = .3) +
geom_label(aes(x = -3, y = -.6),
vjust = 1, hjust = 0, size = 2, label.size = 0.1,
label = paste("R² =",  rsq, "\nRMSE =", rmse)) +
geom_abline() +
theme_pubr()  +
theme(axis.title=element_text(size=7),
axis.line = element_line(size = 0.1),
axis.ticks = element_line(size = 0.1),
axis.text = element_text(size = 6)) +
labs(x= bquote("Observed log"~CO[2]~ 'emision ('*mu~'g'~ h^-1~g^-1*')') , y = bquote("Predicted log"~CO[2]~ 'emision ('*mu~'g'~ h^-1~g^-1*')'))
px
ggsave("figures/Observed and predicted co2 emission.png", width = 4, height = 2, dpi = 600)
options(repr.plot.width = 8, repr.plot.height = 2)
term_rename <- tibble(term = c("`Time (days)`", "`Depth (cm)`", "`Temperature (°C)`"),
name_corrected = c("Time (days)", "Layer (cm)", "Temperature (°C)"))
h <- broom::tidy(model_fit, conf.int = TRUE) |>
dplyr::filter(term != "(Intercept)") |>
left_join(term_rename, by = "term") |>
mutate(term_rename = fct_reorder(name_corrected, estimate)) |>
ggplot(aes(estimate, term_rename)) +
geom_vline(xintercept = 0, linetype = 2) +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.1,
size=0.5) +
labs(x = "Coefficient", y = "") +
theme_light() +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=14))
h
ggsave("figures/Linear-model-Co2.png", width = 8, height = 2, dpi = 600)
New.labs <- c("10°C", "20°C", "30°C") # Change labels
names(New.labs) <- c("10", "20", "30")
New.labs_b <-  c("[0-10 cm]", "[10-20 cm]", "[20-30 cm]") # Change labels
names(New.labs_b) <- c("10", "20", "30")
options(repr.plot.width = 8, repr.plot.height = 6)
pl <- data_co2_clean |>
bind_cols(10^prediction) |>
ggplot(aes(x = `Time (days)`, y = `CO2 emission (ug/h/g)`)) +
geom_point(size = 2, alpha = .3) +
facet_grid(`Depth (cm)` ~ `Temperature (°C)`, scales = "free", labeller = labeller(`Depth (cm)` = New.labs_b, `Temperature (°C)` = New.labs)) +
geom_line(aes(x = `Time (days)`, y = `.pred`)) +
scale_y_log10() +
theme_bw() +
theme(strip.text = element_text(size = 12), axis.text=element_text(size=12),
axis.title=element_text(size=14),
axis.title.y = element_text(size=14)) +
xlab("Incubation time (days)") + ylab(bquote(~CO[2]~ 'emision rate ('*mu~'g'~ h^-1~g^-1*')'))
pl
ggsave("figures/CO2 emission.png", plot= pl, width = 7, height = 5, dpi = 600)
models_co2 <- data_co2 %>%
group_by(`Depth (cm)`) %>%
summarise(linmod = list(lm(lnK ~ `1/T`)))
models_co2
linmod_coef <- list()
for (i in seq_along(models_co2$linmod)) linmod_coef[[i]] <- models_co2$linmod[[i]]$coefficients
linmod_coef <- do.call(rbind.data.frame, linmod_coef)
names(linmod_coef) <- c("Intercept", "Slope")
linmod_coef <- bind_cols(unique(data_co2["Depth (cm)"]), linmod_coef)
linmod_coef
options(repr.plot.width = 12, repr.plot.height = 6)
plot_co2 <- data_co2_clean %>%
ggplot(aes(x = `1/T`, y = lnK)) +
facet_grid(~`Depth (cm)`, labeller = labeller(`Depth (cm)` = New.labs_b)) +
geom_boxplot(aes(group = factor(`1/T`))) +
stat_regline_equation(aes(label =  paste(..eq.label.., ..rr.label.., sep = "~~")), label.x = 0.00331, label.y = -7) +
geom_abline(data = linmod_coef, aes(intercept = Intercept, slope = Slope), lwd = 1) +
labs(y = "ln(K)") +
theme_bw() +
theme(strip.text = element_text(size = 14), axis.text=element_text(size=14),
axis.title=element_text(size=14))
plot_co2
ggsave("figures/Arrhénius équation.png", plot = plot_co2, width = 8, height = 4, dpi = 600)# export plot high resolution
Activation_energy <- tibble(
Soil_layers = c("10", "20", "30"),
intercept = NA,
slope = NA,
adj_r_sq = NA
)
lm_arrhenius <- for (i in 1:nrow(Activation_energy)) {
lm_Activation_energy <- data_co2_clean %>%
filter(`Depth (cm)` == Activation_energy$Soil_layers[i]) %>%
lm(lnK ~ `1/T`, data = .)
# intercept
Activation_energy$intercept[i] <- coef(lm_Activation_energy)[1]
# Slope
Activation_energy$slope[i] <- coef(lm_Activation_energy)[2]
# statistics
Activation_energy$adj_r_sq[i] <- summary(lm_Activation_energy)$adj.r.squared
}
R = 8.3144621 / 1000 # Gas constant Kj/mol/K
Activation_energy <-  Activation_energy %>%
mutate(Ea = -slope * R) %>%
select(Soil_layers, adj_r_sq, Ea)
Activation_energy
K_median <- aggregate(K ~ `Sites` + `Time (days)` + `Depth (cm)` + `Temperature (°C)`, data = data_co2_clean, FUN = median)
K_median <- K_median %>%
pivot_wider(names_from = `Temperature (°C)`, values_from = K)
K_median$Q_20_10 <- K_median$`20` / K_median$`10`
K_median$Q_30_20 <- K_median$`30` / K_median$`20`
K_median <- K_median_02 %>%
na.omit(K_median)
K_median <- aggregate(K ~ `Sites` + `Time (days)` + `Depth (cm)` + `Temperature (°C)`, data = data_co2_clean, FUN = median)
K_median <- K_median %>%
pivot_wider(names_from = `Temperature (°C)`, values_from = K)
K_median$Q_20_10 <- K_median$`20` / K_median$`10`
K_median$Q_30_20 <- K_median$`30` / K_median$`20`
K_median <- K_median %>%
na.omit(K_median)
data_Q10 <- gather(data = K_median, key = `Temperature range`, value = Q10, c(`Q_20_10`, `Q_30_20`),
factor_key=TRUE)
stat_Q10 <- data_Q10 |>
group_by(`Depth (cm)`) |>
get_summary_stats(Q10)
stat_Q10
K_median <- aggregate(K ~ `Sites` + `Time (days)` + `Depth (cm)` + `Temperature (°C)`, data = data_co2_clean, FUN = median)
K_median <- K_median %>%
pivot_wider(names_from = `Temperature (°C)`, values_from = K)
K_median$Q_20_10 <- K_median$`20` / K_median$`10`
K_median$Q_30_20 <- K_median$`30` / K_median$`20`
K_median <- K_median %>%
na.omit(K_median)
data_Q10 <- gather(data = K_median, key = `Temperature range`, value = Q10, c(`Q_20_10`, `Q_30_20`),
factor_key=TRUE)
stat_Q10 <- data_Q10 |>
group_by(`Depth (cm)`) |>
get_summary_stats(Q10)
stat_Q10
New.labs_c <- c("[10°C - 20°C]", "[20°C - 30°C]") # Change labels
names(New.labs_c) <- c("Q_20_10", "Q_30_20")
options(repr.plot.width = 8, repr.plot.height = 4)
data_Q10 |>
mutate(`Layers` = as.character(`Depth (cm)`)) |>
ggplot(aes(x = `Time (days)`, y = `Q10`)) +
facet_grid(`Temperature range`~`Depth (cm)`, labeller = labeller(`Depth (cm)` = New.labs_b,
`Temperature range` = New.labs_c)) +
geom_smooth(method = "lm", se = TRUE, color = "Black") +
geom_point(size = 1.5, alpha = 0.6) +
theme_bw() +
theme(strip.text = element_text(size = 14), axis.text=element_text(size=14),
axis.title=element_text(size=14))
ggsave("figures/Variation of Q10 across layers.png", width = 8, height = 4, dpi = 600)# export plot high resolution
data_carbon_credit <- read_csv2('data/data_carbon_credit.csv')
data_carbon_credit <- data_carbon_credit |>
mutate(`C:N ratio` = `Carbone (%)` / `Nitrogen (%)`)
mean_sd_CoverN <- data_carbon_credit |>
group_by(`Layer (cm)`) |>
summarize(mean_C_over_N = mean(`C:N ratio`, na.rm = TRUE),
se_C_over_N = sd(`C:N ratio`, na.rm = TRUE)/sqrt(length(!is.na(`C:N ratio`))))
mean_sd_CoverN
data_carbon_credit |> get_summary_stats(`C stock (kg m-3)`)
data_carbon_credit |>
group_by(`Layer (cm)`) |>
get_summary_stats(`C stock (kg m-3)`)
data_carbon_credit |>
group_by(`Layer (cm)`) |>
get_summary_stats(`C:N ratio`)
plot_desc <- function(y, ylab){
New.labs_c <-  c("Site/A9", "Site/45") # Change labels
names(New.labs_c) <- c("Belanger/ A9", "Fortier/ 45")
ggplot(data_carbon_credit, aes(`Layer (cm)`, y)) +
facet_grid( . ~ `Location`, scales = "free", labeller = labeller(`Location` = New.labs_c)) +
geom_boxplot() +
theme_bw() +
theme(strip.text = element_text(size = 11), axis.text=element_text(size=11),
axis.title=element_text(size=11)) +
labs(y = ylab)
}
plot1 <- plot_desc(data_carbon_credit$`C stock (kg m-3)`, "C stock (kg m-3)")
plot2 <- plot_desc(data_carbon_credit$`C:N ratio`, "C:N ratio")
plot3 <- plot_desc(data_carbon_credit$`Bulk density (kg m-3)`, "Bulk density (kg m-3)")
plot4 <- plot_desc(data_carbon_credit$pHCaCl2, "pHCaCl2")
plot5 <- plot_desc(data_carbon_credit$`Total porosity`, "Total porosity")
plot6 <- plot_desc(data_carbon_credit$`Water content (%)`, "Water content (%)")
options(repr.plot.width = 8, repr.plot.height = 6)
figure <- ggarrange(plot1, plot2, plot3, plot4, plot5, plot6,
labels = c("A", "B", "C", "D", "E", "F"), label.x = 0.05, label.y = 1.01,
ncol = 2, nrow = 3)
figure
ggsave("figures/Soil description.png", width = 8, height = 5, dpi = 600)# export plot high resolution
Carbon_credit <- read_csv2('data/data_carbon_sublayer.csv')
Carbon_credit
Carbon_credit <- Carbon_credit %>%
mutate(`C/N` = C_pourc/N_pourc)
options(repr.plot.width=8, repr.plot.height=4)
New.labs_d <-  c("Site/A9", "Site/45") # Change labels
names(New.labs_d) <- c("Belanger/A9", "Fortier/45")
ggplot(data=Carbon_credit, aes(x= `Depht (cm)`, y= `C/N`)) +
facet_grid(.~Site, labeller = labeller(`Site` = New.labs_d)) +
geom_line(linetype = "twodash") +
geom_point(aes(shape = `Soil texture`, fill = `Soil texture`), size = 3) +
scale_shape_manual(values=c(21, 21))+
scale_fill_manual(values = c("#000000", "#FFFFFF")) +
scale_y_continuous(breaks = 5*0:1000,
expand = expand_scale(add = 5)) +
scale_x_continuous(breaks = 5*0:1000,
expand = expand_scale(add = 5)) +
theme(strip.text = element_text(face = "bold"), axis.text=element_text(face = "bold"),
axis.title=element_text(face = "bold") , legend.title= element_text(face = "bold"),
legend.text = element_text(face = "bold")) +
labs(y= "C/N Ratio") +
coord_flip()
ggsave("figures/(C_over_N).png", width = 8, height = 4, dpi = 800)
version
